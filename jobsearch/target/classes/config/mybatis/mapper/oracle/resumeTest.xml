<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="config.mybatis.mapper.oracle.resumeTest">
	
	
	<select id="selectResumeList" resultType="resumeVo" parameterType="int">
		Select * From TBL_RESUME 
		Where ref_memberseq = #{memberSeq}
	</select>
	
	<select id="selectResumeListMap" resultType="hashmap" parameterType="int">
		SELECT 
			TR.resume_seq,
            TR.resume_title,
            TR.reg_date,
            TH.hope_salary,
            TC.career_type
        From TBL_RESUME TR
        JOIN TBL_HOPEWORK TH on TR.resume_seq = TH.ref_resumeseq
        JOIN TBL_MYCAREER TC on TR.resume_seq = TC.ref_resumeseq
		Where ref_memberseq = #{memberSeq}
	</select>
	
	<select id="selectMyResumeCount" resultType="int" parameterType="int">
		Select count(*) From TBL_RESUME 
		Where ref_memberseq = #{memberSeq}
	</select>
	
	<insert id="insertResumeTest" parameterType="resumeVo" >
		<selectKey keyProperty="resumeSeq" resultType="int" order="BEFORE">
			select resume_seq.nextval from dual
		</selectKey>
		
		insert into tbl_resume (RESUME_SEQ, RESUME_TITLE, REG_DATE, RESUME_STATUS, RECURIT_STATUS, INTRODUCE_TITLE, INTRODUCE_DESC, REF_MEMBERSEQ )
		values
		(#{resumeSeq}, #{resumeTitle}, sysdate, 2, #{recuritStatus}, #{introduceTitle}, #{introduceDesc}, #{refMemberseq})
	</insert>
	
	
	<resultMap type="HashMap" id="resumeInfo">
		<result property="INTRODUCE_DESC" column="INTRODUCE_DESC" jdbcType="CLOB" javaType="java.lang.String" />
	</resultMap>
	
	<select id="selectMyResumeInfo" parameterType="string" resultType="hashmap" resultMap = "resumeInfo">
	
	Select 
	    tr.resume_seq,
	    tr.resume_title,
	    to_char(tr.reg_date,'yyyy-mm-dd'),
	    tr.resume_status,
	    tr.recurit_status,
	    tr.introduce_title,
	    tr.introduce_desc,
	    tc.mycareer_seq,
	    tc.career_type,
	    tc.pre_comname,
	    to_char(tc.pre_stdt,'yyyy-mm-dd') as PRE_STDT,
	    to_char(tc.pre_endt,'yyyy-mm-dd') as PRE_ENDT,
	    tc.mycareer_seq,
	    tc.retire_desc,
	    tc.manage_desc,
	    th.hopework_seq,
	    th.hope_emptype,
	    th.hope_salary,
	    th.ref_locationseq,
	    th.ref_category1
	From tbl_resume tr
	join tbl_mycareer tc on tr.resume_seq = tc.ref_resumeseq
	join tbl_hopework th on tr.resume_seq = th.ref_resumeseq
	Where resume_seq = #{resumeSeq}
	
	</select>
	
	<update id="updateResumeInfoTest" parameterType = "resumeVo">
		UPDATE TBL_RESUME
		SET RESUME_TITLE = #{resumeTitle},
			INTRODUCE_TITLE = #{introduceTitle},
			INTRODUCE_DESC = #{introduceDesc},
			RECURIT_STATUS = #{recuritStatus},
			REG_DATE = sysdate
		Where resume_seq = #{resumeSeq}
		
	</update>
	
	<delete id="deleteResumeTest" parameterType="string">
		DELETE FROM TBL_RESUME
		WHERE resume_seq = #{resumeSeq}
	</delete>
	
</mapper>