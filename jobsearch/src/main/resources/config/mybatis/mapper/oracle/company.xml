<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="config.mybatis.mapper.oracle.company">
	<!-- 회원 가입 -->
	<insert id="insertCompany" parameterType="companyVo">
		<selectKey keyProperty="comSeq" resultType="int" order="BEFORE">
			select com_seq.nextval from dual
		</selectKey>
		
		insert into TBL_COMPANY
			(
				COM_SEQ, COM_REGNUMBER, COM_NAME, CEO_NAME, COM_DESC, COM_TEL, SETUP_DATE,
				EMPLOYEE_NUM, COM_TYPE ,COM_SALES ,COM_FIELD, COM_IMG , COM_RENAMEIMAGE, REF_MEMBERSEQ 
			)
		values
		(
			#{comSeq}, #{comRegnumber}, #{comName}, #{ceoName}, #{comDesc}, #{comTel}, #{setupDate},
			#{employeeNum}, #{comType} , #{comSales}, #{comField} , #{comImg}, #{comRenameimage}, #{refMemberseq}
		)
	
	</insert>
	
	<select id="selectMaxmemSeq" resultType="int">
		Select max(member_seq) From tbl_member
	</select>

	<select id="selectComInfo" parameterType="int" resultType="companyVo">
		select com_seq,com_regnumber,com_name,ceo_name,com_desc,com_tel, to_char(setup_date,'yyyy-mm-dd')as setup_date ,employee_num,com_type,com_sales,com_field,com_img,com_renameImage,ref_memberseq from tbl_company
		where ref_memberseq=#{memberSeq}		
	</select>
	
	<insert id="insertAnn" parameterType="announceMentVo">
		<selectKey keyProperty="annSeq" resultType="int" order="BEFORE">
			select ann_seq.nextval from dual
		</selectKey>
		insert into tbl_announcement
		(
		ann_seq,ann_title,ann_desc,ann_stdt,ann_endt,career_type,career_desc,employee_type,salary,age_limit,ref_cateseq1,ref_cateseq2,ref_cateseq3,ref_locationseq1,ref_locationseq2,ref_companyseq
		)
		values
		(
		#{annSeq},#{annTitle},#{annDesc},#{annStdt},#{annEndt},#{careerType},#{careerDesc},#{employeeType},#{salary},#{ageLimit},#{refCateseq1},#{refCateseq2},#{refCateseq3},#{refLocationseq1},#{refLocationseq2},#{refCompanyseq}
		)
	</insert>
	
	<update id="updateComMem" parameterType="memberVo">
		update tbl_member
		set member_name=#{memberName},zip_code=#{zipCode},address=#{address},detail_address=#{detailAddress},extra_address=#{extraAddress},phone=#{phone}
		where member_seq=#{memberSeq}
	</update>
	
	<update id="updateComInfo" parameterType="companyVo">
		update tbl_company
		set com_desc=#{comDesc},com_tel=#{comTel},setup_date=#{setupDate},employee_num=#{employeeNum},com_type=#{comType},com_sales=#{comSales},COM_FIELD=#{comField},com_img=#{comImg},com_renameimage=#{comRenameimage}
		where ref_memberseq=#{refMemberseq}
	</update>

	<select id="selectMyAnn" parameterType="int" resultType="announceMentVo">
		select ann_seq,ann_title,ann_desc,to_char(ann_stdt,'yyyy-mm-dd')as ann_stdt,to_char(ann_endt,'yyyy-mm-dd')as ann_endt,career_type,career_desc,employee_type,salary,age_limit,hits,reg_date,ref_cateseq1,ref_cateseq2,ref_cateseq3,ref_locationseq1,ref_locationseq2 from tbl_announcement
		where ref_companyseq=#{refCompanyseq}
	</select>
	
	<select id="selectMyAnnCount" parameterType="int" resultType="int">
		select count(*) from tbl_announcement
		where ref_companyseq=#{refCompanyseq}
	</select>
	
	<select id="selectComImg" parameterType="int" resultType="String">
		select com_renameimage from tbl_company
		where ref_memberseq=#{refMemberseq}
	</select>
	
	<delete id="deleteMyAnn" parameterType="int">
		delete tbl_announcement
		where ANN_SEQ=#{annSeq}
	</delete>
	
	<select id="selectMyAnnByAnnSeq" parameterType="int" resultType="announceMentVo">
		select ann_title,ann_desc,to_char(ann_stdt,'yyyy-mm-dd')as ann_stdt,to_char(ann_endt,'yyyy-mm-dd')as ann_endt,career_type,career_desc,employee_type,salary,age_limit,hits,reg_date,ref_cateseq1,ref_cateseq2,ref_cateseq3,ref_locationseq1,ref_locationseq2 from tbl_announcement
		where ann_seq=#{annSeq}
	</select>
		
</mapper>