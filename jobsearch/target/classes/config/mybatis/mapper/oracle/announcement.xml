<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="config.mybatis.mapper.oracle.announcement">

	
	<resultMap type="HashMap" id="sAnnListByLoc">
		<result property="ANN_DESC" column="ANN_DESC" jdbcType="CLOB" javaType="java.lang.String" />
	</resultMap>
	
	<!-- 지역별 공고 리스트 -->
	<select id="selectAnnListByLoc" parameterType="hashmap" resultType="hashmap" resultMap = "sAnnListByLoc">
		Select * From (	
			Select rownum as rNum, A.* From (	
				SELECT * FROM TBL_ANNOUNCEMENT ta
					join tbl_company tc on ta.ref_companyseq = tc.com_seq
				Where ta.ref_locationseq1 = #{locationSeq1} 
				and ta.ref_locationseq2 in 
				<foreach collection="locList" item="locationSeq2" separator=","	open="(" close=")">
					#{locationSeq2}
				</foreach>
				order by ta.ann_seq desc
			)A
		)B
		Where 1=1 
		<![CDATA[ 
			and (B.rNum >=#{startRow} and B.rNum <= #{endRow})
		]]>

	</select>
	
	<!-- 지역별 공고리스트 카운트 -->
	 <select id="selectAnnListCount" parameterType="hashmap" resultType="int">
	 	SELECT count(*) FROM TBL_ANNOUNCEMENT ta
			join tbl_company tc on ta.ref_companyseq = tc.com_seq
		Where ta.ref_locationseq1 = #{locationSeq1} 
		and ta.ref_locationseq2 in 
		<foreach collection="locList" item="locationSeq2" separator=","	open="(" close=")">
			#{locationSeq2}
		</foreach>
	 </select>
	 
	 <!-- 카테고리별 공고 리스트 -->
	<select id="selectAnnListBycate" parameterType="hashmap" resultType="hashmap" resultMap = "sAnnListByLoc">
		Select * From (	
			Select rownum as rNum, A.* From (	
				SELECT * FROM TBL_ANNOUNCEMENT ta
					join tbl_company tc on ta.ref_companyseq = tc.com_seq
				Where 
					ta.ref_cateseq1 = #{cateSeq1} 
				and	ta.ref_cateseq2 = #{cateSeq2} 
				and ta.ref_cateseq3 in 
				<foreach collection="cateList" item="cateSeq3" separator=","	open="(" close=")">
					#{cateSeq3}
				</foreach>
				order by ta.ann_seq desc
			)A
		)B
		Where 1=1 
		<![CDATA[ 
			and (B.rNum >=#{startRow} and B.rNum <= #{endRow})
		]]>
	</select>
	
	<!-- 직업별 공고 수 카운트 -->
	 <select id="selectAnnListCountBycate" parameterType="hashmap" resultType="int">
	 	SELECT count(*) FROM TBL_ANNOUNCEMENT ta
			join tbl_company tc on ta.ref_companyseq = tc.com_seq
		Where ta.ref_cateseq1 = #{cateSeq1}
		and ta.ref_cateseq2 = #{cateSeq2} 
		and ta.ref_cateseq3 in 
		<foreach collection="cateList" item="cateSeq3" separator=","	open="(" close=")">
			#{cateSeq3}
		</foreach>
	 </select>
	 

	 	

	
</mapper>